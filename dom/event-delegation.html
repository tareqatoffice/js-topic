<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Event Delegation</title>
    <style>
      body { font-family: system-ui, sans-serif; padding: 20px; }
      #list { padding: 0; }
      #list li { list-style: none; padding: 8px 12px; border: 1px solid #ddd; margin: 6px 0; cursor: pointer; }
      #log { white-space: pre; background: #111; color: #0f0; padding: 12px; min-height: 120px; }
      button { margin-top: 12px; }
    </style>
  </head>
  <body>
    <h1>Event Delegation</h1>

    <ul id="list">
      <li data-id="1"><a href="#one">Item 1</a></li>
      <li data-id="2"><a href="#two">Item 2</a></li>
      <li data-id="3"><a href="#three">Item 3</a></li>
    </ul>

    <button id="add">Add item</button>

    <h3>Log</h3>
    <div id="log"></div>

    <script>
      const list = document.getElementById('list');
      const add = document.getElementById('add');
      const logEl = document.getElementById('log');
      let counter = 3;

      function log(msg) {
        logEl.textContent += msg + "\n";
        logEl.scrollTop = logEl.scrollHeight;
      }

      // One listener handles clicks on current and future items
      list.addEventListener('click', (e) => {
        // Prevent default navigation if a link was clicked
        const link = e.target.closest('a');
        if (link && list.contains(link)) {
          e.preventDefault();
        }
        const li = e.target.closest('li');
        if (!li || !list.contains(li)) return; // click happened outside items
        log(`clicked item id=${li.dataset.id}`);
      });

      add.addEventListener('click', () => {
        counter++;
        const li = document.createElement('li');
        li.dataset.id = String(counter);
        const a = document.createElement('a');
        a.href = `#${counter}`;
        a.textContent = `Item ${counter}`;
        li.appendChild(a);
        list.appendChild(li);
        log(`added item ${counter}`);
      });

      // Notes:
      // - Delegation attaches one listener on a common ancestor.
      // - e.target is the innermost element; use closest('selector') to traverse up.
      // - Works for dynamically added elements without new listeners per item.
    </script>
  </body>
</html>
